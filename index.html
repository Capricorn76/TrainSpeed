<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkul치tor Brzd칤c칤ch Procent</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>游뚝</text></svg>">
<style>
    /* --- Z츼KLADN칈 (SV캨TL칗) STYL --- */
    :root {
        --barva-pozadi: #000000;
        --barva-kontejneru: #fff;
        --barva-textu: #333;
        --barva-ramecku: #ddd;
        --barva-vysledek-pozadi: #e9ecef;
        --barva-tlumeneho-textu: #6c757d; 
        --barva-navesti: #FF8C00; /* Tmav코칤 oran쬺v치 */
        
        /* Barvy pro tla캜칤tka */
        --tlacitko-hlavni: #007bff;
        --tlacitko-hlavni-hover: #0056b3;
        --tlacitko-reset: #dc3545;
        --tlacitko-reset-hover: #c82333;
    }

    /* --- TMav칳 RE콯IM (DARK MODE) --- */
    body.dark-mode {
        --barva-pozadi: #121212;
        --barva-kontejneru: #1f1f1f;
        --barva-textu: #ffffff;
        --barva-ramecku: #3a3a3a;
        --barva-vysledek-pozadi: #2d2d2d;
        --barva-tlumeneho-textu: white;
        --barva-navesti: #FF8C00; 
    }
    
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: var(--barva-pozadi);
        color: var(--barva-textu);
        transition: background-color 0.3s, color 0.3s;
    }
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background-color: var(--barva-kontejneru);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2); 
        border-radius: 12px;
    }
    h1 {
        color: var(--barva-textu);
        text-align: center;
    }
    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
    
    /* *** ZM캨NA ZDE: Zv캩t코en칤 p칤sma v zad치vac칤ch pol칤ch *** */
    input[type="number"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        box-sizing: border-box;
        border: 1px solid var(--barva-ramecku);
        border-radius: 6px; 
        background-color: var(--barva-kontejneru); 
        color: var(--barva-textu);
        font-size: 2em; /* ZV캨TEN칈 P칈SMA NA 2X */
        height: 50px; /* P콏id치no pro lep코칤 zarovn치n칤 */
    }

    /* --- STYLY TLA캛칈TEK --- */
    .tlacitka {
        display: flex;
        gap: 15px; 
        margin-top: 20px;
    }
    .tlacitka button {
        flex-grow: 1; 
        color: white; 
        padding: 12px 15px;
        border: none;
        border-radius: 8px; 
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); 
    }
    
    /* Hlavn칤 tla캜칤tko (Vypo캜칤tat) */
    .tlacitka .main-button {
        background-color: var(--tlacitko-hlavni);
    }
    .tlacitka .main-button:hover {
        background-color: var(--tlacitko-hlavni-hover);
        transform: translateY(-2px); 
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    /* Reset tla캜칤tko (Vynulovat) */
    .tlacitka .reset-button {
        background-color: var(--tlacitko-reset); 
    }
    .tlacitka .reset-button:hover {
        background-color: var(--tlacitko-reset-hover);
        transform: translateY(-2px); 
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    /* --- STYLY V칗SLEDKU --- */
    #vysledek {
        margin-top: 25px;
        padding: 15px;
        border: 1px solid var(--barva-ramecku);
        background-color: var(--barva-vysledek-pozadi);
        border-radius: 8px;
    }
    #vysledek p {
        margin: 5px 0;
        font-size: 1.1em;
    }
    .vysledek-hlavni {
        font-weight: bold;
        color: #28a745; /* Zelen치 pro Novou rychlost */
        font-size: 1.2em;
    }
    /* T콎칈DA PRO RYCHLOST U N츼V캨STI */
    .vysledek-navest {
        font-weight: bold;
        color: var(--barva-navesti); 
        font-size: 1.2em;
    }
    .footer {
        margin-top: 20px;
        text-align: right;
        font-size: 0.8em;
        color: var(--barva-tlumeneho-textu); 
        opacity: 0.9;
    }

    /* Styl pro pozn치mky/postup v칳po캜tu */
    #vysledek hr + p {
         color: var(--barva-tlumeneho-textu) !important;
    }
    
    /* Styl pro p콏ep칤na캜 */
    .theme-switcher {
        text-align: right;
        margin-bottom: 10px;
    }
    .switch {
        position: relative;
        display: inline-block;
        width: 45px;
        height: 25px;
    }
    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 25px;
    }
    .slider:before {
        position: absolute;
        content: "";
        height: 19px;
        width: 19px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: #2196F3;
    }
    input:checked + .slider:before {
        transform: translateX(19px);
    }
</style>
</head>
<body>

<div class="container">
    <div class="theme-switcher">
        Tmav칳 re쬴m:
        <label class="switch">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
        </label>
    </div>

    <h1>游뚝 Kalkul치tor Rychlosti Vlaku</h1>
    <p>Zadejte pot콏ebn칠 a skute캜n칠 brzd칤c칤 procenta a maxim치ln칤 rychlost pro v칳po캜et sn칤쬰n칤 rychlosti.</p>
    
<label for="potrebnaBrzdna">Pot콏ebn치 brzd칤c칤 %:</label>
<input type="number" id="potrebnaBrzdna" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, 'skutecnaBrzdna')">

<label for="skutecnaBrzdna">Skute캜n치 brzd칤c칤 %:</label>
<input type="number" id="skutecnaBrzdna" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, 'maxRychlost')">

<label for="maxRychlost">Maxim치ln칤 rychlost vlaku (V_max):</label>
<input type="number" id="maxRychlost" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, null)">
    
    <div class="tlacitka">
        <button class="main-button" onclick="vypocitejRychlost()">Vypo캜칤tat Novou Rychlost</button>
        <button class="reset-button" onclick="resetHodnoty()">Vynulovat hodnoty</button>
    </div>
    
    <div id="vysledek">
        </div>

    <div class="footer">
        Created by PetrLepi캜
    </div>
</div>

<script>
    // --- FUNKCE PRO DARK MODE ---
    function enableDarkMode(shouldSave = true) {
        document.body.classList.add('dark-mode');
        document.getElementById('darkModeToggle').checked = true;
        if (typeof localStorage !== 'undefined' && shouldSave) {
            localStorage.setItem('darkMode', 'enabled');
        }
    }

    function disableDarkMode(shouldSave = true) {
        document.body.classList.remove('dark-mode');
        document.getElementById('darkModeToggle').checked = false;
        if (typeof localStorage !== 'undefined' && shouldSave) {
            localStorage.setItem('darkMode', 'disabled');
        }
    }

    // --- FUNKCE PRO P콎ESKAKOV츼N칈 MEZI POLI KL츼VESOU ENTER (PRO PC) ---
    function handleEnterKey(event, nextElementId) {
        // Kontrola, zda byla stisknuta kl치vesa Enter (KeyCode 13)
        if (event.keyCode === 13) {
            event.preventDefault(); // Zabr치n칤 v칳choz칤mu chov치n칤 (nap콏. odesl치n칤 formul치콏e)
            
            // Pokud je definovan칠 dal코칤 ID, p콏esu켿 fokus
            if (nextElementId) {
                document.getElementById(nextElementId).focus();
            } else {
                // Pokud je toto posledn칤 pole, spus콘 v칳po캜et
                vypocitejRychlost();
            }
        }
    }


    // --- FUNKCE PRO RESET ---
    function resetHodnoty() {
        document.getElementById('potrebnaBrzdna').value = 0;
        document.getElementById('skutecnaBrzdna').value = 0;
        document.getElementById('maxRychlost').value = 0;
        document.getElementById('vysledek').innerHTML = '';
        // Po resetu nastav fokus zp캩t na prvn칤 pole pro snaz코칤 zad치v치n칤
        document.getElementById('potrebnaBrzdna').focus(); 
    }
    
    // --- FUNKCE PRO V칗PO캛ET RYCHLOSTI (zde ponech치no beze zm캩ny) ---
    function vypocitejRychlost() {
        const potrebnaBrzdna = parseFloat(document.getElementById('potrebnaBrzdna').value);
        const skutecnaBrzdna = parseFloat(document.getElementById('skutecnaBrzdna').value);
        const maxRychlost = parseFloat(document.getElementById('maxRychlost').value);

        const vysledekDiv = document.getElementById('vysledek');
        vysledekDiv.innerHTML = '';
        
        if (isNaN(potrebnaBrzdna) || isNaN(skutecnaBrzdna) || isNaN(maxRychlost) || potrebnaBrzdna < 0 || skutecnaBrzdna < 0 || maxRychlost < 0) {
            vysledekDiv.innerHTML = '<p style="color: red;">Zadejte platn칠 kladn칠 캜칤seln칠 hodnoty (nebo nulu).</p>';
            return;
        }

        let novaRychlost = maxRychlost;
        let chybejiciProcenta = potrebnaBrzdna - skutecnaBrzdna;
        let snizeniRychlosti = 0;
        let poznamky = [];
        
        if (maxRychlost === 0 && chybejiciProcenta > 0) {
            vysledekDiv.innerHTML = '<p class="vysledek-hlavni" style="color: red;"><strong>Maxim치ln칤 rychlost vlaku je 0 km/h. Nelze prov칠st v칳po캜et sn칤쬰n칤.</strong></p>';
            return;
        }

        if (chybejiciProcenta <= 0) {
            novaRychlost = maxRychlost;
            snizeniRychlosti = 0;
            poznamky.push(`Skute캜n치 b.% (${skutecnaBrzdna} %) jsou dosta캜uj칤c칤.`);
            
            vysledekDiv.innerHTML = `
                <p><strong>Chyb캩j칤c칤 %:</strong> 0</p>
                <p><strong>Sn칤쬰n칤 rychlosti:</strong> 0 km/h</p>
                <p class="vysledek-hlavni" style="color: #28a745;"><strong>Nov치 maxim치ln칤 rychlost:</strong> ${maxRychlost} km/h</p>
                <hr><p style="font-size: 0.8em; color: var(--barva-tlumeneho-textu); margin-top: 10px;"><strong>Postup v칳po캜tu:</strong><br>${poznamky.join('<br>')}</p>
            `;
            return;
        } 
        
        // V칳po캜et sn칤쬰n칤
        if (skutecnaBrzdna <= 45) {
            snizeniRychlosti = chybejiciProcenta * 2;
            poznamky.push(`Skute캜n치 brzd칤c칤 % jsou ${skutecnaBrzdna} (<= 45), sn칤쬰n칤 je ${chybejiciProcenta} * 2 = ${snizeniRychlosti} km/h.`);
        } else {
            snizeniRychlosti = chybejiciProcenta * 1;
            poznamky.push(`Skute캜n치 brzd칤c칤 % jsou ${skutecnaBrzdna} (> 45), sn칤쬰n칤 je ${chybejiciProcenta} * 1 = ${snizeniRychlosti} km/h.`);
        }

        let zakladniSnizenaRychlost = maxRychlost - snizeniRychlosti;
        novaRychlost = zakladniSnizenaRychlost;
        poznamky.push(`Z치kladn칤 sn칤쬰n치 rychlost (V_nov치): ${maxRychlost} - ${snizeniRychlosti} = ${zakladniSnizenaRychlost} km/h.`);

        // Zv치쬰n칤 rozkladu (pro V_max > 120 km/h)
        if (maxRychlost > 120) {
            const rychlostSNaveT = zakladniSnizenaRychlost - 20;
            poznamky.push(`Maxim치ln칤 rychlost vlaku (${maxRychlost} km/h) je > 120 km/h, zva쬿je se "Rozklad".`);
            
            if (rychlostSNaveT >= 120) {
                // Rozklad LZE POU콯칈T
                poznamky.push(`Rychlost u n치v캩sti v칳straha (${rychlostSNaveT} km/h) je >= 120 km/h. Rozklad LZE POU콯칈T. Plat칤 ob캩 rychlosti.`);
                
                vysledekDiv.innerHTML += `
                    <p><strong>Chyb캩j칤c칤 %:</strong> ${chybejiciProcenta}</p>
                    <p><strong>Sn칤쬰n칤 rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                    <p class="vysledek-hlavni"><strong>Nov치 maxim치ln칤 rychlost:</strong> ${zakladniSnizenaRychlost} km/h</p>
                    <p class="vysledek-navest"><strong>Rychlost u n치v캩sti v칳straha:</strong> ${rychlostSNaveT} km/h</p>
                `;
                novaRychlost = zakladniSnizenaRychlost;
            } else {
                // Rozklad NELZE POU콯칈T: Plat칤 pouze NI콯먞 RYCHLOST (rychlostSNaveT)
                novaRychlost = rychlostSNaveT; 
                
                poznamky.push(`Rychlost u n치v캩sti v칳straha (${rychlostSNaveT} km/h) je < 120 km/h. Rozklad NELZE POU콯칈T. Kone캜n치 rychlost je NI콯먞: ${novaRychlost} km/h.`);
                
                vysledekDiv.innerHTML += `
                    <p><strong>Chyb캩j칤c칤 %:</strong> ${chybejiciProcenta}</p>
                    <p><strong>Sn칤쬰n칤 rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                    <p class="vysledek-hlavni"><strong>Nov치 maxim치ln칤 rychlost (Kone캜n치):</strong> ${novaRychlost} km/h</p>
                    <p style="font-size: 0.9em; color: var(--barva-navesti);"> (Rozklad nelze pou쮂셦. Kone캜n치 rychlost je ${novaRychlost} km/h.)</p>
                `;
            }
        } else {
            // Rychlosti 120 km/h a m칠n캩 - bez rozkladu
            novaRychlost = zakladniSnizenaRychlost;
            poznamky.push(`Maxim치ln칤 rychlost vlaku (${maxRychlost} km/h) NEN칈 > 120 km/h. Rozklad se NE콎E먞.`);

             vysledekDiv.innerHTML += `
                <p><strong>Chyb캩j칤c칤 %:</strong> ${chybejiciProcenta}</p>
                <p><strong>Sn칤쬰n칤 rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                <p class="vysledek-hlavni"><strong>Nov치 maxim치ln칤 rychlost:</strong> ${novaRychlost} km/h</p>
            `;
        }

        if (novaRychlost < 0) {
             vysledekDiv.innerHTML = '<p class="vysledek-hlavni" style="color: red;"><strong>Nov치 maxim치ln칤 rychlost:</strong> 0 km/h. Kritick칳 nedostatek brzd칤c칤ch procent!</p>';
             novaRychlost = 0;
        }
        
        // Zobrazen칤 pozn치mek (pro kontrolu)
        vysledekDiv.innerHTML += '<hr><p style="font-size: 0.8em; color: var(--barva-tlumeneho-textu); margin-top: 10px;"><strong>Postup v칳po캜tu:</strong><br>' + poznamky.join('<br>') + '</p>';
    }

    // --- NA캛TEN칈 PREFERENC칈 A P콎IPOJEN칈 POSLUCHA캛E P콎I NA캛TEN칈 STR츼NKY ---
    document.addEventListener('DOMContentLoaded', () => {
        const darkModeToggle = document.getElementById('darkModeToggle');
        
        // 1. Na캜ten칤 a nastaven칤 ulo쬰n칠ho stavu (persistence)
        if (typeof localStorage !== 'undefined' && localStorage.getItem('darkMode') === 'enabled') {
            enableDarkMode(false);
        } else {
            disableDarkMode(false);
        }

        // 2. TENTO BLOK JE KL칈캛OV칗: P콏ipojen칤 event listeneru pro p콏ep칤n치n칤
        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                enableDarkMode();
            } else {
                disableDarkMode();
            }
        });
    });
</script></body>

</html>
