<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalkul√°tor Brzd√≠c√≠ch Procent</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üöÇ</text></svg>">
<style>
    /* --- Z√ÅKLADN√ç (SVƒöTL√ù) STYL --- */
    :root {
        --barva-pozadi: #000000;
        --barva-kontejneru: #fff;
        --barva-textu: #333;
        --barva-ramecku: #ddd;
        --barva-vysledek-pozadi: #e9ecef;
        --barva-tlumeneho-textu: #6c757d; 
        --barva-navesti: #FF8C00; /* Tmav≈°√≠ oran≈æov√° */
        
        /* Barvy pro tlaƒç√≠tka */
        --tlacitko-hlavni: #007bff;
        --tlacitko-hlavni-hover: #0056b3;
        --tlacitko-reset: #dc3545;
        --tlacitko-reset-hover: #c82333;
    }

    /* --- TMav√Ω RE≈ΩIM (DARK MODE) --- */
    body.dark-mode {
        --barva-pozadi: #121212;
        --barva-kontejneru: #1f1f1f;
        --barva-textu: #ffffff;
        --barva-ramecku: #3a3a3a;
        --barva-vysledek-pozadi: #2d2d2d;
        --barva-tlumeneho-textu: white;
        --barva-navesti: #FF8C00; 
    }
    
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: var(--barva-pozadi);
        color: var(--barva-textu);
        transition: background-color 0.3s, color 0.3s;
    }
    .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background-color: var(--barva-kontejneru);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2); 
        border-radius: 12px;
    }
    h1 {
        color: var(--barva-textu);
        text-align: center;
    }
    label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }
    
    /* *** ZMƒöNA ZDE: Zvƒõt≈°en√≠ p√≠sma v zad√°vac√≠ch pol√≠ch *** */
    input[type="number"] {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        box-sizing: border-box;
        border: 1px solid var(--barva-ramecku);
        border-radius: 6px; 
        background-color: var(--barva-kontejneru); 
        color: var(--barva-textu);
        font-size: 2em; /* ZVƒöT≈†EN√ç P√çSMA NA 2X */
        height: 50px; /* P≈ôid√°no pro lep≈°√≠ zarovn√°n√≠ */
    }

    /* --- STYLY TLAƒå√çTEK --- */
    .tlacitka {
        display: flex;
        gap: 15px; 
        margin-top: 20px;
    }
    .tlacitka button {
        flex-grow: 1; 
        color: white; 
        padding: 12px 15px;
        border: none;
        border-radius: 8px; 
        cursor: pointer;
        font-size: 16px;
        font-weight: bold;
        transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); 
    }
    
    /* Hlavn√≠ tlaƒç√≠tko (Vypoƒç√≠tat) */
    .tlacitka .main-button {
        background-color: var(--tlacitko-hlavni);
    }
    .tlacitka .main-button:hover {
        background-color: var(--tlacitko-hlavni-hover);
        transform: translateY(-2px); 
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    /* Reset tlaƒç√≠tko (Vynulovat) */
    .tlacitka .reset-button {
        background-color: var(--tlacitko-reset); 
    }
    .tlacitka .reset-button:hover {
        background-color: var(--tlacitko-reset-hover);
        transform: translateY(-2px); 
        box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
    }

    /* --- STYLY V√ùSLEDKU --- */
    #vysledek {
        margin-top: 25px;
        padding: 15px;
        border: 1px solid var(--barva-ramecku);
        background-color: var(--barva-vysledek-pozadi);
        border-radius: 8px;
    }
    #vysledek p {
        margin: 5px 0;
        font-size: 1.1em;
    }
    .vysledek-hlavni {
        font-weight: bold;
        color: #28a745; /* Zelen√° pro Novou rychlost */
        font-size: 1.2em;
    }
    /* T≈ò√çDA PRO RYCHLOST U N√ÅVƒöSTI */
    .vysledek-navest {
        font-weight: bold;
        color: var(--barva-navesti); 
        font-size: 1.2em;
    }
    .footer {
        margin-top: 20px;
        text-align: right;
        font-size: 0.8em;
        color: var(--barva-tlumeneho-textu); 
        opacity: 0.9;
    }

    /* Styl pro pozn√°mky/postup v√Ωpoƒçtu */
    #vysledek hr + p {
         color: var(--barva-tlumeneho-textu) !important;
    }
    
    /* Styl pro p≈ôep√≠naƒç */
    .theme-switcher {
        text-align: right;
        margin-bottom: 10px;
    }
    .switch {
        position: relative;
        display: inline-block;
        width: 45px;
        height: 25px;
    }
    .switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 25px;
    }
    .slider:before {
        position: absolute;
        content: "";
        height: 19px;
        width: 19px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
    }
    input:checked + .slider {
        background-color: #2196F3;
    }
    input:checked + .slider:before {
        transform: translateX(19px);
    }
</style>
</head>
<body>

<div class="container">
    <div class="theme-switcher">
        Tmav√Ω re≈æim:
        <label class="switch">
            <input type="checkbox" id="darkModeToggle">
            <span class="slider"></span>
        </label>
    </div>

    <h1>üöÇ Kalkul√°tor Rychlosti Vlaku</h1>
    <p>Zadejte pot≈ôebn√© a skuteƒçn√© brzd√≠c√≠ procenta a maxim√°ln√≠ rychlost pro v√Ωpoƒçet sn√≠≈æen√≠ rychlosti.</p>
    
<label for="potrebnaBrzdna">Pot≈ôebn√° brzd√≠c√≠ %:</label>
<input type="number" id="potrebnaBrzdna" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, 'skutecnaBrzdna')">

<label for="skutecnaBrzdna">Skuteƒçn√° brzd√≠c√≠ %:</label>
<input type="number" id="skutecnaBrzdna" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, 'maxRychlost')">

<label for="maxRychlost">Maxim√°ln√≠ rychlost vlaku (V_max):</label>
<input type="number" id="maxRychlost" value="0" min="0" onfocus="this.select()" onkeydown="handleEnterKey(event, null)">
    
    <div class="tlacitka">
        <button class="main-button" onclick="vypocitejRychlost()">Vypoƒç√≠tat Novou Rychlost</button>
        <button class="reset-button" onclick="resetHodnoty()">Vynulovat hodnoty</button>
    </div>
    
    <div id="vysledek">
        </div>

    <div class="footer">
        Created by PetrLepiƒç
    </div>
</div>

<script>
    // --- FUNKCE PRO DARK MODE ---
    function enableDarkMode(shouldSave = true) {
        document.body.classList.add('dark-mode');
        document.getElementById('darkModeToggle').checked = true;
        if (typeof localStorage !== 'undefined' && shouldSave) {
            localStorage.setItem('darkMode', 'enabled');
        }
    }

    function disableDarkMode(shouldSave = true) {
        document.body.classList.remove('dark-mode');
        document.getElementById('darkModeToggle').checked = false;
        if (typeof localStorage !== 'undefined' && shouldSave) {
            localStorage.setItem('darkMode', 'disabled');
        }
    }

    // --- FUNKCE PRO P≈òESKAKOV√ÅN√ç MEZI POLI KL√ÅVESOU ENTER (PRO PC) ---
    function handleEnterKey(event, nextElementId) {
        // Kontrola, zda byla stisknuta kl√°vesa Enter (KeyCode 13)
        if (event.keyCode === 13) {
            event.preventDefault(); // Zabr√°n√≠ v√Ωchoz√≠mu chov√°n√≠ (nap≈ô. odesl√°n√≠ formul√°≈ôe)
            
            // Pokud je definovan√© dal≈°√≠ ID, p≈ôesu≈à fokus
            if (nextElementId) {
                document.getElementById(nextElementId).focus();
            } else {
                // Pokud je toto posledn√≠ pole, spus≈• v√Ωpoƒçet
                vypocitejRychlost();
            }
        }
    }


    // --- FUNKCE PRO RESET ---
    function resetHodnoty() {
        document.getElementById('potrebnaBrzdna').value = 0;
        document.getElementById('skutecnaBrzdna').value = 0;
        document.getElementById('maxRychlost').value = 0;
        document.getElementById('vysledek').innerHTML = '';
        // Po resetu nastav fokus zpƒõt na prvn√≠ pole pro snaz≈°√≠ zad√°v√°n√≠
        document.getElementById('potrebnaBrzdna').focus(); 
    }
    
    // --- FUNKCE PRO V√ùPOƒåET RYCHLOSTI (zde ponech√°no beze zmƒõny) ---
    function vypocitejRychlost() {
        const potrebnaBrzdna = parseFloat(document.getElementById('potrebnaBrzdna').value);
        const skutecnaBrzdna = parseFloat(document.getElementById('skutecnaBrzdna').value);
        const maxRychlost = parseFloat(document.getElementById('maxRychlost').value);

        const vysledekDiv = document.getElementById('vysledek');
        vysledekDiv.innerHTML = '';
        
        if (isNaN(potrebnaBrzdna) || isNaN(skutecnaBrzdna) || isNaN(maxRychlost) || potrebnaBrzdna < 0 || skutecnaBrzdna < 0 || maxRychlost < 0) {
            vysledekDiv.innerHTML = '<p style="color: red;">Zadejte platn√© kladn√© ƒç√≠seln√© hodnoty (nebo nulu).</p>';
            return;
        }

        let novaRychlost = maxRychlost;
        let chybejiciProcenta = potrebnaBrzdna - skutecnaBrzdna;
        let snizeniRychlosti = 0;
        let poznamky = [];
        
        if (maxRychlost === 0 && chybejiciProcenta > 0) {
            vysledekDiv.innerHTML = '<p class="vysledek-hlavni" style="color: red;"><strong>Maxim√°ln√≠ rychlost vlaku je 0 km/h. Nelze prov√©st v√Ωpoƒçet sn√≠≈æen√≠.</strong></p>';
            return;
        }

        if (chybejiciProcenta <= 0) {
            novaRychlost = maxRychlost;
            snizeniRychlosti = 0;
            poznamky.push(`Skuteƒçn√° b.% (${skutecnaBrzdna} %) jsou dostaƒçuj√≠c√≠.`);
            
            vysledekDiv.innerHTML = `
                <p><strong>Chybƒõj√≠c√≠ %:</strong> 0</p>
                <p><strong>Sn√≠≈æen√≠ rychlosti:</strong> 0 km/h</p>
                <p class="vysledek-hlavni" style="color: #28a745;"><strong>Nov√° maxim√°ln√≠ rychlost:</strong> ${maxRychlost} km/h</p>
                <hr><p style="font-size: 0.8em; color: var(--barva-tlumeneho-textu); margin-top: 10px;"><strong>Postup v√Ωpoƒçtu:</strong><br>${poznamky.join('<br>')}</p>
            `;
            return;
        } 
        
        // V√Ωpoƒçet sn√≠≈æen√≠
        if (skutecnaBrzdna <= 45) {
            snizeniRychlosti = chybejiciProcenta * 2;
            poznamky.push(`Skuteƒçn√° brzd√≠c√≠ % jsou ${skutecnaBrzdna} (<= 45), sn√≠≈æen√≠ je ${chybejiciProcenta} * 2 = ${snizeniRychlosti} km/h.`);
        } else {
            snizeniRychlosti = chybejiciProcenta * 1;
            poznamky.push(`Skuteƒçn√° brzd√≠c√≠ % jsou ${skutecnaBrzdna} (> 45), sn√≠≈æen√≠ je ${chybejiciProcenta} * 1 = ${snizeniRychlosti} km/h.`);
        }

        let zakladniSnizenaRychlost = maxRychlost - snizeniRychlosti;
        novaRychlost = zakladniSnizenaRychlost;
        poznamky.push(`Z√°kladn√≠ sn√≠≈æen√° rychlost (V_nov√°): ${maxRychlost} - ${snizeniRychlosti} = ${zakladniSnizenaRychlost} km/h.`);

        // Zv√°≈æen√≠ rozkladu (pro V_max > 120 km/h)
        if (maxRychlost > 120) {
            const rychlostSNaveT = zakladniSnizenaRychlost - 20;
            poznamky.push(`Maxim√°ln√≠ rychlost vlaku (${maxRychlost} km/h) je > 120 km/h, zva≈æuje se "Rozklad".`);
            
            if (rychlostSNaveT >= 120) {
                // Rozklad LZE POU≈Ω√çT
                poznamky.push(`Rychlost u n√°vƒõsti v√Ωstraha (${rychlostSNaveT} km/h) je >= 120 km/h. Rozklad LZE POU≈Ω√çT. Plat√≠ obƒõ rychlosti.`);
                
                vysledekDiv.innerHTML += `
                    <p><strong>Chybƒõj√≠c√≠ %:</strong> ${chybejiciProcenta}</p>
                    <p><strong>Sn√≠≈æen√≠ rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                    <p class="vysledek-hlavni"><strong>Nov√° maxim√°ln√≠ rychlost:</strong> ${zakladniSnizenaRychlost} km/h</p>
                    <p class="vysledek-navest"><strong>Rychlost u n√°vƒõsti v√Ωstraha:</strong> ${rychlostSNaveT} km/h</p>
                `;
                novaRychlost = zakladniSnizenaRychlost;
            } else {
                // Rozklad NELZE POU≈Ω√çT: Plat√≠ pouze NI≈Ω≈†√ç RYCHLOST (rychlostSNaveT)
                novaRychlost = rychlostSNaveT; 
                
                poznamky.push(`Rychlost u n√°vƒõsti v√Ωstraha (${rychlostSNaveT} km/h) je < 120 km/h. Rozklad NELZE POU≈Ω√çT. Koneƒçn√° rychlost je NI≈Ω≈†√ç: ${novaRychlost} km/h.`);
                
                vysledekDiv.innerHTML += `
                    <p><strong>Chybƒõj√≠c√≠ %:</strong> ${chybejiciProcenta}</p>
                    <p><strong>Sn√≠≈æen√≠ rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                    <p class="vysledek-hlavni"><strong>Nov√° maxim√°ln√≠ rychlost (Koneƒçn√°):</strong> ${novaRychlost} km/h</p>
                    <p style="font-size: 0.9em; color: var(--barva-navesti);"> (Rozklad nelze pou≈æ√≠t. Koneƒçn√° rychlost je ${novaRychlost} km/h.)</p>
                `;
            }
        } else {
            // Rychlosti 120 km/h a m√©nƒõ - bez rozkladu
            novaRychlost = zakladniSnizenaRychlost;
            poznamky.push(`Maxim√°ln√≠ rychlost vlaku (${maxRychlost} km/h) NEN√ç > 120 km/h. Rozklad se NE≈òE≈†√ç.`);

             vysledekDiv.innerHTML += `
                <p><strong>Chybƒõj√≠c√≠ %:</strong> ${chybejiciProcenta}</p>
                <p><strong>Sn√≠≈æen√≠ rychlosti:</strong> ${snizeniRychlosti} km/h</p>
                <p class="vysledek-hlavni"><strong>Nov√° maxim√°ln√≠ rychlost:</strong> ${novaRychlost} km/h</p>
            `;
        }

        if (novaRychlost < 0) {
             vysledekDiv.innerHTML = '<p class="vysledek-hlavni" style="color: red;"><strong>Nov√° maxim√°ln√≠ rychlost:</strong> 0 km/h. Kritick√Ω nedostatek brzd√≠c√≠ch procent!</p>';
             novaRychlost = 0;
        }
        
        // Zobrazen√≠ pozn√°mek (pro kontrolu)
        vysledekDiv.innerHTML += '<hr><p style="font-size: 0.8em; color: var(--barva-tlumeneho-textu); margin-top: 10px;"><strong>Postup v√Ωpoƒçtu:</strong><br>' + poznamky.join('<br>') + '</p>';
    }

    // --- NAƒåTEN√ç PREFERENC√ç A P≈òIPOJEN√ç POSLUCHAƒåE P≈òI NAƒåTEN√ç STR√ÅNKY ---
    document.addEventListener('DOMContentLoaded', () => {
        const darkModeToggle = document.getElementById('darkModeToggle');
        
        // 1. Naƒçten√≠ a nastaven√≠ ulo≈æen√©ho stavu (persistence)
        if (typeof localStorage !== 'undefined' && localStorage.getItem('darkMode') === 'enabled') {
            enableDarkMode(false);
        } else {
            disableDarkMode(false);
        }

        // 2. TENTO BLOK JE KL√çƒåOV√ù: P≈ôipojen√≠ event listeneru pro p≈ôep√≠n√°n√≠
        darkModeToggle.addEventListener('change', () => {
            if (darkModeToggle.checked) {
                enableDarkMode();
            } else {
                disableDarkMode();
            }
        });
    });
</script></body>

</html>
